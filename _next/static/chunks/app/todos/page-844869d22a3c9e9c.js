(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[648],{321:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=a(3464).A.create({baseURL:"https://backend-to-do-list-ys4a.onrender.com/task/api/v1/",headers:{"Content-Type":"application/json"}})},1660:(e,t,a)=>{"use strict";a.d(t,{A:()=>i,O:()=>c});var r=a(5155),s=a(2115),l=a(5695),n=a(321);let o=(0,s.createContext)(void 0),c=e=>{let{children:t}=e,[a,c]=(0,s.useState)(null),[i,d]=(0,s.useState)(null),u=(0,l.useRouter)(),[h,m]=(0,s.useState)(!0);(0,s.useEffect)(()=>{let e=localStorage.getItem("token"),t=localStorage.getItem("email");e&&t&&(d(e),c({email:t})),m(!1)},[]);let x=async(e,t)=>{try{let a=await n.A.post("/auth/login",{email:e,password:t});console.log(a.data);let{token:r,email:s}=a.data;if(!r)throw Error("No se recibi\xf3 un token");if(!s)throw Error("No se recibi\xf3 un email");localStorage.setItem("token",r),localStorage.setItem("email",s),d(r),c({email:s}),u.push("/todos")}catch(e){throw console.error("Error en login:",e),Error((null==e?void 0:e.message)||"Error al iniciar sesi\xf3n")}};return(0,r.jsx)(o.Provider,{value:{user:a,token:i,login:x,logout:()=>{localStorage.removeItem("token"),localStorage.removeItem("email"),d(null),c(null),u.push("/login")},isLoading:h},children:t})},i=()=>{let e=(0,s.useContext)(o);if(!e)throw Error("useAuth debe usarse dentro de <AuthProvider>");return e}},4684:(e,t,a)=>{Promise.resolve().then(a.bind(a,8628))},8628:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>m});var r=a(5155),s=a(2115),l=a(5695),n=a(1660);function o(){let{user:e,logout:t}=(0,n.A)();return(0,r.jsxs)("nav",{className:"bg-gray-100 p-4 flex justify-between items-center",children:[(0,r.jsxs)("span",{children:["Hola, ",null==e?void 0:e.email," "]}),(0,r.jsx)("button",{onClick:t,className:"bg-red-600 text-white px-4 py-1",children:"Cerrar sesi\xf3n"})]})}var c=a(321);function i(){let{token:e}=(0,n.A)(),[t,a]=(0,s.useState)(""),[l,o]=(0,s.useState)(""),[i,d]=(0,s.useState)(""),[u,h]=(0,s.useState)(!1),m=async r=>{if(r.preventDefault(),t.trim()&&l.trim()&&i)try{let r={nombre:t,descripcion:l,fechaLimite:new Date(i),estado:u};await c.A.post("/tareas",r,{headers:{Authorization:"Bearer ".concat(e)}}),a(""),o(""),d(""),h(!1)}catch(e){console.error("Error al crear tarea:",e)}};return(0,r.jsxs)("form",{onSubmit:m,className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 max-w-screen-xl w-full",children:[(0,r.jsx)("input",{type:"text",placeholder:"Nombre",value:t,onChange:e=>a(e.target.value),className:"border border-gray-300 px-3 py-2 rounded w-full"}),(0,r.jsx)("input",{type:"text",placeholder:"Descripci\xf3n",value:l,onChange:e=>o(e.target.value),className:"border border-gray-300 px-3 py-2 rounded w-full"}),(0,r.jsx)("input",{type:"date",value:i,onChange:e=>d(e.target.value),className:"border border-gray-300 px-3 py-2 rounded w-full"}),(0,r.jsx)("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded w-full",children:"Agregar"})]})}function d(e){let{task:t,onDelete:a,onUpdate:l}=e,{token:o}=(0,n.A)(),[i,d]=(0,s.useState)(!1),[u,h]=(0,s.useState)(t.nombre),[m,x]=(0,s.useState)(t.descripcion),[p,g]=(0,s.useState)(t.fechaLimite),[b,j]=(0,s.useState)(t.estado),[f,v]=(0,s.useState)(!1),y=async()=>{try{d(!0),await c.A.patch("/tareas/".concat(t.id,"/estado"),{estado:!b},{headers:{Authorization:"Bearer ".concat(o)}}),l()}catch(e){console.error("Error al cambiar el estatus:",e)}finally{d(!1)}},N=async()=>{try{d(!0),await c.A.patch("/tareas/".concat(t.id),{nombre:u,descripcion:m,fechaLimite:p,estado:b},{headers:{Authorization:"Bearer ".concat(o)}}),v(!1),l()}catch(e){console.error("Error al actualizar la tarea:",e)}finally{d(!1)}};return(0,r.jsx)("div",{className:"bg-white border rounded p-3 shadow-sm space-y-1",children:f?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium",children:"Nombre"}),(0,r.jsx)("input",{type:"text",value:u,onChange:e=>h(e.target.value),className:"mt-1 p-2 border rounded w-full"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium",children:"Descripci\xf3n"}),(0,r.jsx)("textarea",{value:m,onChange:e=>x(e.target.value),className:"mt-1 p-2 border rounded w-full"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium",children:"Fecha L\xedmite"}),(0,r.jsx)("input",{type:"date",value:p,onChange:e=>g(e.target.value),className:"mt-1 p-2 border rounded w-full"})]}),(0,r.jsx)("div",{className:"flex items-center gap-2 mt-2",children:(0,r.jsxs)("label",{children:["Estado:",(0,r.jsx)("input",{type:"checkbox",checked:b,onChange:e=>j(e.target.checked),className:"ml-2"}),b?"Completada":"Pendiente"]})}),(0,r.jsxs)("div",{className:"mt-2",children:[(0,r.jsx)("button",{onClick:N,className:"text-green-600 hover:underline mr-2",disabled:i,children:i?"Actualizando...":"Actualizar Tarea"}),(0,r.jsx)("button",{onClick:()=>v(!1),className:"text-gray-600 hover:underline",children:"Cancelar"})]})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Nombre:"})," ",t.nombre]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Descripci\xf3n:"})," ",t.descripcion]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Creaci\xf3n:"})," ",t.fechaCreacion]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Finalizaci\xf3n:"})," ",t.fechaLimite]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Estado:"})," ",t.estado?"Completada":"Pendiente"]}),(0,r.jsxs)("div",{className:"flex items-center justify-between mt-2",children:[(0,r.jsx)("button",{onClick:()=>a(t.id),className:"text-red-600 hover:underline",children:"Eliminar"}),(0,r.jsx)("button",{onClick:()=>v(!0),className:"text-blue-600 hover:underline",children:"Editar"}),(0,r.jsxs)("label",{className:"flex items-center gap-2 text-sm",children:[(0,r.jsx)("input",{type:"checkbox",checked:t.estado,onChange:y,disabled:i}),t.estado?"Completada":"Pendiente"]})]})]})})}let u=(0,a(4298).io)("https://backend-to-do-list-ys4a.onrender.com/");function h(){let{token:e}=(0,n.A)(),[t,a]=(0,s.useState)([]),l=async()=>{try{let t=await c.A.get("/tareas",{headers:{Authorization:"Bearer ".concat(e)}});a(t.data)}catch(e){console.error("Error cargando tareas:",e)}},o=async t=>{try{await c.A.delete("/tareas/".concat(t),{headers:{Authorization:"Bearer ".concat(e)}}),l()}catch(e){console.error("Error al eliminar tarea:",e)}};return(0,s.useEffect)(()=>(l(),u.on("tareaCreada",e=>{a(t=>[e,...t])}),()=>{u.off("tareaCreada")}),[]),(0,r.jsx)("div",{className:"space-y-4 mt-6",children:t.map(e=>(0,r.jsx)(d,{task:e,onDelete:o,onUpdate:l},e.id))})}function m(){let{user:e,token:t}=(0,n.A)(),a=(0,l.useRouter)();return((0,s.useEffect)(()=>{e&&t||a.push("/login")},[e,t]),e&&t)?(0,r.jsxs)("div",{className:"min-h-screen p-6 bg-gray-50 text-black",children:[(0,r.jsx)(o,{}),(0,r.jsxs)("div",{className:"max-w-2xl mx-auto mt-10 space-y-6 text-cyan-800",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold",children:"Tus tareas"}),(0,r.jsx)(i,{}),(0,r.jsx)(h,{})]})]}):(0,r.jsx)("div",{children:"Verificando sesi\xf3n..."})}}},e=>{var t=t=>e(e.s=t);e.O(0,[794,298,441,684,358],()=>t(4684)),_N_E=e.O()}]);